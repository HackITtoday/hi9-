<link rel="import" href="../bower_components/mediator-data/mediator-data.html">

<dom-module id="firebase-data">
  <template>
    <mediator-data data="{{data}}" location="{{userUrl}}" log log-to="https://open-elements.firebaseio.com/root/log.json"></mediator-data>
  </template>
</dom-module>
<script>
  ;(function () {
    var log
    Polymer({
      is: 'firebase-data',
      properties: {
        data:{ 
          type: Object, notify: true, observer: '_dataChanged'
        },
        userUrl: {
          computed:"getUserDataUrl(uid)"
        },
        uid: String
      },
      getUserDataUrl: function(uid) {
        return "https://hi9site.firebaseio.com/users/" + uid;
      },
      get: function(val){
        return val
      },
      _dataChanged: function(data) {
        if (!data) {
          this.data = {};
        } else if (!log) {
          log = true
          if (!this.data.log) {
            this.data.log = [{first:new Date}]
          } else {
            this.data.log.push({next:new Date})
          }
          this.set("data.log",this.data.log,this)
          
          this.set("log",this.data.log,this.data)
        }
      }
    });
  })();
</script>
